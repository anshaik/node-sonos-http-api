'use strict';
var request = require('request-promise');
var clientId = '6b9ec970f07f410376f1db1dfa8d71b3';
var apiBaseEndpoint = 'http://api.soundcloud.com';
var settings = {};

try {
  settings = require.main.require('./settings.json');
} catch (e) {
}

settings.soundcloud = settings.soundcloud || clientId;

var endpoints = {
  track: '/tracks/'
};
/*
function parseUri(uri) {
  // x-sonos-http:track%3a232202756.mp3?sid=160&flags=8224&sn=10
  var id;
  if (/x-sonos-http:track%3a(\d+)\./.test(uri)) {
    id = RegExp.$1;
  }

  return {
    id
  };

}

function tryGetHighResArt(uri) {
  var trackInfo = parseUri(uri);

  var apiUrl = [
    apiBaseEndpoint,
    endpoints.track,
    trackInfo.id,
    '?client_id=',
    settings.soundcloud
  ].join('');

  return request({
    url: apiUrl,
    json: true
  })
    .then((response) => {
      var artwork;

      // jscs:disable requireCamelCaseOrUpperCaseIdentifiers
      /* jshint -W106 *//*
      if (response.artwork_url) {
        artwork = response.artwork_url.replace('large', 't500x500');
      }

      // jscs:enable requireCamelCaseOrUpperCaseIdentifiers
      /* jshint +W106 *//*

      return artwork;
    });
}

module.exports = function (services) {
  services[160] = {
    tryGetHighResArt
  };
};*/
